<!DOCTYPE html> <!-- Определяет документ как HTML5 -->
<html lang="ru"> <!-- Устанавлиет язык страницы — русский -->
<head> <!-- Начало секции метаданных -->
  <meta charset="UTF-8"> <!-- Задает кодировку документа в UTF-8 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Обеспечивает адаптивность под разные экраны -->
  <title>Выберите Ваш банк для оплаты</title> <!-- Текст, отображаемый в заголовке вкладки -->
  <style> /* Начало блока стилей CSS */
    html, body { /* Сбрасываем отступы и задаем высоту для html и body */
      margin: 0; /* Убираем внешние отступы */
      padding: 0; /* Убираем внутренние отступы */
      height: 100%; /* Задаем высоту в 100% от окна браузера */
    }
    body { /* Стили для тега body */
      background-image: url('background.png'); /* Фоновое изображение страницы */
      background-size: cover; /* Заставляет фон покрывать весь контейнер */
      background-position: center; /* Центрирует фоновое изображение */
      display: flex; /* Включает флекс-контейнер для body */
      flex-direction: column; /* Располагает содержимое по вертикали */
    }
    .header { /* Стили для контейнера шапки */
      display: flex; /* Включает флекс-контейнер */
      align-items: center; /* Выравнивает элементы по вертикали по центру */
      padding: 10px; /* Внутренний отступ вокруг содержимого шапки */
      background-color: rgba(255,255,255,0.5); /* Полупрозрачный белый фон */
      backdrop-filter: blur(6px); /* Размывает фон позади шапки */
      -webkit-backdrop-filter: blur(6px); /* Размывает фон в Safari */
    }
    .back-btn { /* Стили для кнопки «← Вернуться» */
      border: none; /* Убирает рамку кнопки */
      background: none; /* Делает фон прозрачным */
      font-size: 16px; /* Размер текста кнопки */
      color: #333; /* Цвет текста кнопки */
      cursor: pointer; /* Курсор «рука» при наведении */
      margin-right: auto; /* Отодвигает кнопку от правого края шапки */
    }
    .main-logo { /* Стили для изображения логотипа */
      width: 80px; /* Фиксированная ширина логотипа */
      height: auto; /* Автоматическая высота для сохранения пропорций */
    }
    .bank-list { /* Стили для контейнера списка банков */
      flex: 1; /* Занимает все доступное пространство по вертикали */
      overflow-y: auto; /* Позволяет вертикальную прокрутку */
      padding: 10px; /* Внутренний отступ вокруг списка */
      -webkit-overflow-scrolling: touch; /* Плавная прокрутка на iOS */
      overscroll-behavior: contain; /* Отключает системный эффект «упора» */
      overscroll-behavior-y: contain; /* Отключает вертикальный «упор» */
    }
    @keyframes slideUp { /* Определение ключевой анимации slideUp */
      0% {
        transform: translateY(100px); /* Начальное смещение вниз на 100px */
        opacity: 0; /* Начальная прозрачность */
      }
      80% {
        transform: translateY(-6px); /* Отскок вверх на 6px */
        opacity: 1; /* Полная видимость */
      }
      100% {
        transform: translateY(0); /* Возвращение в исходное положение */
        opacity: 1; /* Остается полностью видимым */
      }
    }
    .btn { /* Общие стили для кнопок банков */
      width: 100%; /* Занимает всю ширину контейнера */
      max-width: 500px; /* Не расширяется более чем на 500px */
      margin: 8px auto; /* Верхний/нижний отступ 8px, по центру горизонтально */
      padding: 12px; /* Внутренний отступ внутри кнопок */
      border: none; /* Без рамки */
      border-radius: 12px; /* Скругленные углы радиусом 12px */
      background: linear-gradient( /* Градиент фона кнопки */
        to right,
        white 0%, /* Белый цвет в начале */
        white 15%, /* Белый цвет до 15% ширины */
        rgba(255,255,255,0.2) 50%, /* Полупрозрачный белый на середине */
        rgba(255,255,255,0) 100% /* Полностью прозрачный к концу */
      );
      backdrop-filter: blur(6px); /* Размывает фон под кнопкой */
      -webkit-backdrop-filter: blur(6px); /* Размывает фон в Safari */
      cursor: pointer; /* Курсор «рука» при наведении */
      display: flex; /* Flex-контейнер для содержимого кнопки */
      align-items: center; /* Выравнивает содержимое по вертикали */
      opacity: 0; /* Скрытые до запуска анимации */
      transform: translateY(100px); /* Предварительный сдвиг вниз */
    }
    .btn img { /* Стили для иконки внутри кнопки */
      width: 32px; /* Фиксированная ширина иконки */
      height: auto; /* Автовысота для сохранения пропорций */
      margin-right: 12px; /* Отступ справа между иконкой и текстом */
    }
    .btn-text { /* Стили для текста внутри кнопки */
      font-family: 'Helvetica Neue', Arial, sans-serif; /* Шрифт текста */
      font-weight: bold; /* Жирное начертание */
      font-size: 16px; /* Размер шрифта */
      color: #000; /* Цвет текста — черный */
      text-shadow: 0 0 1px rgba(0,0,0,0.2); /* Легкое размытие по контуру для читаемости */
    }
    .btn:nth-child(1)  { animation-delay: 0.00s; } /* Задержка старта анимации для 1-й кнопки */
    .btn:nth-child(2)  { animation-delay: 0.05s; } /* для 2-й кнопки */
    .btn:nth-child(3)  { animation-delay: 0.10s; } /* для 3-й кнопки */
    .btn:nth-child(4)  { animation-delay: 0.15s; } /* и т.д. */
    .btn:nth-child(5)  { animation-delay: 0.20s; }
    .btn:nth-child(6)  { animation-delay: 0.25s; }
    .btn:nth-child(7)  { animation-delay: 0.30s; }
    .btn:nth-child(8)  { animation-delay: 0.35s; }
    .btn:nth-child(9)  { animation-delay: 0.40s; }
    .btn:nth-child(10) { animation-delay: 0.45s; }
    .btn:nth-child(11) { animation-delay: 0.50s; }
  </style> <!-- Конец блока CSS -->
</head>
<body> <!-- Начало тела документа -->

  <div class="header"> <!-- Контейнер шапки -->
    <button class="back-btn" onclick="closePage()">← Вернуться</button> <!-- Кнопка возврата -->
    <img src="LOGO.png" alt="Ваш логотип" class="main-logo"> <!-- Логотип -->
  </div>

  <div class="bank-list"> <!-- Контейнер списка банков -->
    <button class="btn"
      onclick="openLink('sberpayapp://', 'https://online.sberbank.ru/CSAFront/index.do')">
      <img src="LOGO_SBER.png" alt="Сбербанк"> <!-- Иконка Сбербанка -->
      <span class="btn-text">Сбербанк</span> <!-- Текст кнопки -->
    </button>
    <button class="btn"
      onclick="openLink('alfabank://account', 'https://web.alfabank.ru/dashboard')">
      <img src="LOGO_ALFABANK.png" alt="Альфа-Банк">
      <span class="btn-text">Альфа-Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('tbank://main', 'https://www.tbank.ru/mybank/')">
      <img src="LOGO_TBANK.png" alt="Т-Банк">
      <span class="btn-text">Т-Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('rshbmbfl://', 'https://online.rshb.ru/cas-auth/index?forceAuth=true')">
      <img src="LOGO_RSHB.png" alt="Россельхозбанк">
      <span class="btn-text">Россельхозбанк</span>
    </button>
    <button class="btn"
      onclick="openLink('gpbapp://', 'https://ib.online.gpb.ru/')">
      <img src="LOGO_GAZPROMBANK.png" alt="Газпромбанк">
      <span class="btn-text">Газпромбанк</span>
    </button>
    <button class="btn"
      onclick="openLink('psbmobile://auth/accounts', 'https://ib.psbank.ru/settings')">
      <img src="LOGO_PSB.png" alt="ПСБ">
      <span class="btn-text">ПСБ</span>
    </button>
    <button class="btn"
      onclick="openLink('mkb2://deeplink', 'https://online.mkb.ru/login')">
      <img src="LOGO_MKB.png" alt="МКБ">
      <span class="btn-text">МКБ</span>
    </button>
    <button class="btn"
      onclick="openLink('vtb://vtb.ru/i/', 'https://online.vtb.ru/login')">
      <img src="LOGO_VTB.png" alt="ВТБ">
      <span class="btn-text">ВТБ</span>
    </button>
    <button class="btn"
      onclick="openLink('mtsmoney://', 'https://sso.mtsbank.ru/login/mtsmoney/auth/')">
      <img src="LOGO_MTSBANK.png" alt="МТС Банк">
      <span class="btn-text">МТС Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('bank100000000016://sbpay', 'https://my.pochtabank.ru/login')">
      <img src="LOGO_POCHTABANK.png" alt="Почта Банк">
      <span class="btn-text">Почта Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('ompshared://', 'https://bk.sovcombank.ru/ru/html/login.html')">
      <img src="LOGO_SOVKOMBANK.png" alt="Совкомбанк">
      <span class="btn-text">Совкомбанк</span>
    </button>
  </div>

  <script> /* Начало блока JavaScript */
    // Функция для вызова клиента Telegram и закрытия вкладки
    function closePage() {
      window.location.href = 'tg://'; // Редирект на схему tg:// — запускает Telegram
      setTimeout(function() {         // Ждем 100 мс перед закрытием
        window.close();               // Закрываем текущее окно/вкладку
      }, 100);                         // Время задержки — 100 мс
    }

    // Функция для открытия ссылки банка и автоматического закрытия вкладки
    function openLink(androidUrl, webUrl) {
      var ua = navigator.userAgent || ''; // Читаем User-Agent браузера
      var isIOS = /iPhone|iPad|iPod/.test(ua); // Проверяем, iOS ли устройство
      var isTelegramWebView = /Telegram\/\d+\.\d+/.test(ua); // Встроенный WebView Telegram?
      var isAndroid = /Android/.test(ua);   // Проверяем Android

      if (isAndroid) {                      // Если Android:
        window.location.href = androidUrl;  //   Переходим по Deeplink
      }
      else if (isIOS && isTelegramWebView) { // Если iOS в WebView Telegram:
        window.open(webUrl, '_blank', 'noopener'); // Открываем в Safari
      }
      else {                                // Во всех остальных случаях:
        window.open(webUrl, '_blank');      //   Открываем веб-ссылку в новой вкладке
      }

      setTimeout(function() {               // Ждем 200 мс перед закрытием
        window.close();                     //   Закрываем текущее окно/вкладку
      }, 200);                              // Время задержки — 200 мс
    }

    // Функция предзагрузки изображений: фон и иконки
    function preloadImages(urls, callback) {
      var loaded = 0;                       // Счетчик загруженных файлов
      function onLoad() {                   // Коллбэк при завершении загрузки или ошибке
        if (++loaded === urls.length) {    // Как только все изображения обработаны:
          callback();                      //   Вызываем переданную функцию
        }
      }
      urls.forEach(function(url) {         // Для каждого URL изображения:
        var img = new Image();             //   Создаем DOM-элемент Image
        img.onload  = onLoad;              //   На успешную загрузку — onLoad
        img.onerror = onLoad;              //   На ошибку — тоже onLoad
        img.src     = url;                 //   Запускаем загрузку, установив src
      });
    }

    // Ждем полной загрузки DOM, затем запускаем логику
    document.addEventListener('DOMContentLoaded', function() {
      var bgCss  = window.getComputedStyle(document.body).backgroundImage; // Получаем CSS background-image
      var bgUrl  = bgCss.slice(5, -2);        // Извлекаем URL из form `url("...")`
      var imgEls = Array.from(document.querySelectorAll('img')); // Собираем все <img> элементы
      var imgUrls = imgEls.map(function(img) { return img.src; }); // Массив src всех картинок
      var allUrls = [bgUrl].concat(imgUrls); // Объединяем URL фона и иконок в один массив

      preloadImages(allUrls, startAnim);      // Предзагружаем все картинки, затем анимируем кнопки

      var list     = document.querySelector('.bank-list'); // Ссылка на контейнер банка
      var buttons  = Array.from(document.querySelectorAll('.btn')); // Массив всех кнопок
      var startY   = 0;                       // Начальная координата Y при таче
      var touching = false;                   // Флаг: пользователь сейчас тачет по списку

      // Обработка начала касания по списку
      list.addEventListener('touchstart', function(e) {
        touching = true;                      // Входим в состояние тача
        startY   = e.touches[0].clientY;      // Запоминаем Y-координату первого касания
      });

      // Обработка движения пальца по списку
      list.addEventListener('touchmove', function(e) {
        if (!touching) return;                // Если не в таче — выходим
        var delta = e.touches[0].clientY - startY;            // Смещение по Y
        var scale = 1 + Math.min(Math.abs(delta) / 200, 0.1); // Масштаб растяжения до +10%

        // Если «уперлись» в начало или конец списка:
        if ((list.scrollTop === 0 && delta > 0) ||
            (list.scrollTop + list.clientHeight >= list.scrollHeight && delta < 0)) {
          buttons.forEach(function(btn) {      // Для каждой кнопки:
            btn.style.transform = 'scaleY(' + scale + ')';   // Растягиваем по высоте
            var newMargin = 8 * scale;        // Вычисляем новый margin на основе scale
            btn.style.margin = newMargin + 'px auto'; // Применяем вертикальный margin
          });
        }
      });

      // Обработка окончания касания по списку
      list.addEventListener('touchend', function() {
        touching = false;                     // Выходим из состояния тача
        buttons.forEach(function(btn) {       // Для каждой кнопки:
          btn.style.transition = 'transform 0.3s, margin 0.3s'; // Добавляем плавный переход
          btn.style.transform  = 'scaleY(1)'; // Возвращаем нормальную высоту
          btn.style.margin     = '8px auto';  // Возвращаем исходный margin
          setTimeout(function() {             // После окончания анимации:
            btn.style.transition = '';        // Убираем свойство transition
          }, 300);                            // Задержка равна длительности анимации
        });
      });
    });

    // Запускает анимацию slideUp для всех кнопок с задержками
    function startAnim() {
      document.querySelectorAll('.btn').forEach(function(btn, i) {
        btn.style.animation = 'slideUp 0.6s ease-out both ' + (i * 0.05) + 's'; // Применяем анимацию
      });
    }
  </script> <!-- Конец блока JavaScript -->

</body>
</html>
