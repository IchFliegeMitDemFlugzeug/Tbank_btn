<!DOCTYPE html> <!-- Определяем документ как HTML5 -->
<html lang="ru"> <!-- Устанавливаем язык страницы — русский -->
<head> <!-- Начало секции метаданных -->
  <meta charset="UTF-8"> <!-- Кодировка документа UTF-8 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Адаптивность под ширину экрана -->
  <title>Выберите Ваш банк для оплаты</title> <!-- Заголовок вкладки браузера -->
  <style> /* Начало блока CSS */
    html, body {               /* Сбрасываем отступы и задаём высоту */
      margin: 0;               /* Убираем внешние отступы */
      padding: 0;              /* Убираем внутренние отступы */
      height: 100%;            /* Задаём высоту 100% от окна */
    }
    body {                     /* Оформление фона и flex-контейнера */
      background-image: url('background.png'); /* Фон из файла background.png */
      background-size: cover;  /* Покрытие всего экрана фоном */
      background-position: center; /* Центрирование фонового изображения */
      display: flex;           /* Flex-контейнер */
      flex-direction: column;  /* Располагаем элементы в колонку */
    }
    .header {                  /* Шапка страницы */
      display: flex;           /* Flex-контейнер */
      align-items: center;     /* Вертикальное выравнивание по центру */
      padding: 10px;           /* Внутренний отступ */
      background-color: rgba(255,255,255,0.5); /* Полупрозрачный фон */
      backdrop-filter: blur(6px);      /* Размытие фона за шапкой */
      -webkit-backdrop-filter: blur(6px); /* Для Safari */
    }
    .back-btn {                /* Кнопка «← Вернуться» */
      border: none;            /* Без рамки */
      background: none;        /* Прозрачный фон */
      font-size: 16px;         /* Размер шрифта */
      color: #333;             /* Цвет текста */
      cursor: pointer;         /* Курсор «рука» */
      margin-right: auto;      /* Сдвигаем логотип вправо */
    }
    .main-logo {               /* Логотип в шапке */
      width: 80px;             /* Фиксированная ширина */
      height: auto;            /* Авто-высота для пропорций */
    }
    .bank-list {               /* Контейнер со списком банков */
      flex: 1;                 /* Занимает всё доступное пространство */
      overflow-y: auto;        /* Вертикальная прокрутка */
      padding: 10px;           /* Внутренние отступы */
      -webkit-overflow-scrolling: touch; /* Плавная прокрутка на iOS */
    }
    @keyframes slideUp {       /* Анимация «выезд снизу» */
      0% {
        transform: translateY(100px); /* Сдвиг вниз на 100px */
        opacity: 0;                   /* Прозрачность: 0 */
      }
      80% {
        transform: translateY(-6px);     /* Возвращение на место */
        opacity: 1;                   /* Полная видимость */
      }
      100% {
        transform: translateY(0);     /* Остаёмся на месте */
        opacity: 1;                   /* Полная видимость */
      }
    }
    .btn {                     /* Общие стили кнопок банков */
      width: 100%;             /* По ширине контейнера */
      max-width: 500px;        /* Не более 500px */
      margin: 8px auto;        /* Вертикальные отступы и центрирование */
      padding: 12px;           /* Внутренний отступ */
      border: none;            /* Без рамки */
      border-radius: 12px;     /* Скруглённые углы */
      background: linear-gradient( /* Градиент от белого к прозрачному */
        to right,
        white 0%,
        white 15%,
        rgba(255,255,255,0.2) 50%,
        rgba(255,255,255,0) 100%
      );
      backdrop-filter: blur(6px);      /* Размытие фона под кнопкой */
      -webkit-backdrop-filter: blur(6px); /* Для Safari */
      cursor: pointer;         /* Курсор «рука» */
      display: flex;           /* Flex для иконки и текста */
      align-items: center;     /* Вертикальное выравнивание по центру */
      opacity: 0;              /* Скрытые до анимации */
      transform: translateY(100px); /* Начальный сдвиг вниз */
    }
    .btn img {                 /* Иконка банка внутри кнопки */
      width: 32px;             /* Фиксированная ширина */
      height: auto;            /* Автовысота для пропорций */
      margin-right: 12px;      /* Отступ справа от иконки */
    }
    .btn-text {                /* Текст внутри кнопки */
      font-family: 'Helvetica Neue', Arial, sans-serif; /* Минималистичный шрифт */
      font-weight: bold;       /* Жирный */
      font-size: 16px;         /* Размер текста */
      color: #000;             /* Чёрный цвет */
      text-shadow: 0 0 1px rgba(0,0,0,0.2); /* Тонкое размытие по контуру */
    }
    /* Задержки анимации для каждой кнопки */
    .btn:nth-child(1)  { animation-delay: 0.00s; }
    .btn:nth-child(2)  { animation-delay: 0.05s; }
    .btn:nth-child(3)  { animation-delay: 0.10s; }
    .btn:nth-child(4)  { animation-delay: 0.15s; }
    .btn:nth-child(5)  { animation-delay: 0.20s; }
    .btn:nth-child(6)  { animation-delay: 0.25s; }
    .btn:nth-child(7)  { animation-delay: 0.30s; }
    .btn:nth-child(8)  { animation-delay: 0.35s; }
    .btn:nth-child(9)  { animation-delay: 0.40s; }
    .btn:nth-child(10) { animation-delay: 0.45s; }
    .btn:nth-child(11) { animation-delay: 0.50s; }
  </style> <!-- Конец блока CSS -->
</head>
<body> <!-- Начало тела страницы -->

  <!-- Шапка с кнопкой возврата и логотипом -->
  <div class="header">
    <button class="back-btn" onclick="closePage()">← Вернуться</button>
    <img src="LOGO.png" alt="Ваш логотип" class="main-logo">
  </div>

  <!-- Список банков -->
  <div class="bank-list">
    <button class="btn"
      onclick="openLink('sberpayapp://', 'https://online.sberbank.ru/CSAFront/index.do')">
      <img src="LOGO_SBER.png" alt="Сбербанк">
      <span class="btn-text">Сбербанк</span>
    </button>
    <button class="btn"
      onclick="openLink('alfabank://account', 'https://web.alfabank.ru/dashboard')">
      <img src="LOGO_ALFABANK.png" alt="Альфа-Банк">
      <span class="btn-text">Альфа-Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('tbank://main', 'https://www.tbank.ru/mybank/')">
      <img src="LOGO_TBANK.png" alt="Т-Банк">
      <span class="btn-text">Т-Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('rshbmbfl://', 'https://online.rshb.ru/cas-auth/index?forceAuth=true')">
      <img src="LOGO_RSHB.png" alt="Россельхозбанк">
      <span class="btn-text">Россельхозбанк</span>
    </button>
    <button class="btn"
      onclick="openLink('gpbapp://', 'https://ib.online.gpb.ru/')">
      <img src="LOGO_GAZPROMBANK.png" alt="Газпромбанк">
      <span class="btn-text">Газпромбанк</span>
    </button>
    <button class="btn"
      onclick="openLink('psbmobile://auth/accounts', 'https://ib.psbank.ru/settings')">
      <img src="LOGO_PSB.png" alt="ПСБ">
      <span class="btn-text">ПСБ</span>
    </button>
    <button class="btn"
      onclick="openLink('mkb2://deeplink', 'https://online.mkb.ru/login')">
      <img src="LOGO_MKB.png" alt="МКБ">
      <span class="btn-text">МКБ</span>
    </button>
    <button class="btn"
      onclick="openLink('vtb://vtb.ru/i/', 'https://online.vtb.ru/login')">
      <img src="LOGO_VTB.png" alt="ВТБ">
      <span class="btn-text">ВТБ</span>
    </button>
    <button class="btn"
      onclick="openLink('mtsmoney://', 'https://sso.mtsbank.ru/login/mtsmoney/auth/')">
      <img src="LOGO_MTSBANK.png" alt="МТС Банк">
      <span class="btn-text">МТС Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('bank100000000016://sbpay', 'https://my.pochtabank.ru/login')">
      <img src="LOGO_POCHTABANK.png" alt="Почта Банк">
      <span class="btn-text">Почта Банк</span>
    </button>
    <button class="btn"
      onclick="openLink('ompshared://', 'https://bk.sovcombank.ru/ru/html/login.html')">
      <img src="LOGO_SOVKOMBANK.png" alt="Совкомбанк">
      <span class="btn-text">Совкомбанк</span>
    </button>
  </div>

  <script> 
  /**
   * Закрывает вкладку, предварительно вызвав клиент Telegram.
   */
  function closePage() {
    // 1) Перенаправляем текущую страницу на схему tg://,
    //    что должно запустить нативный клиент Telegram.
    window.location.href = 'tg://';
    // 2) Через 100 мс пытаемся закрыть вкладку/окно,
    //    чтобы не оставлять пустую вкладку в браузере.
    setTimeout(function() {
      window.close();
    }, 100);
  }

  /**
   * Открывает ссылку банка и автоматически закрывает вкладку.
   * @param {string} androidUrl — Deeplink для Android (например, 'sberpayapp://').
   * @param {string} webUrl     — Веб-ссылка (например, 'https://online.sberbank.ru/...').
   */
  function openLink(androidUrl, webUrl) {
    // Получаем строку User-Agent для определения платформы.
    var ua = navigator.userAgent || '';

    // Признак iOS-устройства (iPhone, iPad, iPod).
    var isIOS = /iPhone|iPad|iPod/.test(ua);
    // Признак встраиваемого браузера Telegram (есть «Telegram/XX» в UA).
    var isTelegramWebView = /Telegram\/\d+\.\d+/.test(ua);
    // Признак Android
    var isAndroid = /Android/.test(ua);

    if (isAndroid) {
      // На Android сразу запускаем Deeplink,
      // чтобы открыть приложение банка напрямую.
      window.location.href = androidUrl;
    }
    else if (isIOS && isTelegramWebView) {
      // На iOS в Telegram WebView: открываем в Safari
      // через window.open с target _blank и rel=noopener,
      // что вынудит систему использовать внешний браузер.
      window.open(webUrl, '_blank', 'noopener');
    }
    else {
      // Во всех остальных случаях (десктоп, мобильный вне Telegram):
      // открываем веб-версию в новой вкладке.
      window.open(webUrl, '_blank');
    }

    // Через 200 мс после перехода пытаемся закрыть вкладку,
    // чтобы дать время на срабатывание deeplink/web-url.
    setTimeout(function() {
      window.close();
    }, 200);
  }

  /**
   * Предзагружает все изображения (включая фон),
   * и только после этого запускает анимацию кнопок.
   * (Оставляем без изменений.)
   */
  function preloadImages(urls, callback) {
    var loaded = 0;
    function onLoad() {
      if (++loaded === urls.length) {
        callback();
      }
    }
    urls.forEach(function(url) {
      var img = new Image();
      img.onload  = onLoad;
      img.onerror = onLoad;
      img.src     = url;
    });
  }

  // После загрузки DOM устанавливаем поведение:
  document.addEventListener('DOMContentLoaded', function() {
    // Собираем URL фонового изображения
    var bgCss   = window.getComputedStyle(document.body).backgroundImage;
    var bgUrl   = bgCss.slice(5, -2);
    // Собираем все <img> на странице
    var imgEls  = Array.from(document.querySelectorAll('img'));
    var imgUrls = imgEls.map(function(img) { return img.src; });
    var allUrls = [bgUrl].concat(imgUrls);

    // Предзагрузка и анимация кнопок
    preloadImages(allUrls, startAnim);

    // Реализация «растяжки» кнопок при «упоре» прокрутки (остается без изменений)
    var list     = document.querySelector('.bank-list');
    var buttons  = document.querySelectorAll('.btn');
    var startY   = 0;
    var touching = false;

    list.addEventListener('touchstart', function(e) {
      touching = true;
      startY   = e.touches[0].clientY;
    });
    list.addEventListener('touchmove', function(e) {
      if (!touching) return;
      var delta = e.touches[0].clientY - startY;
      var scale = 1 + Math.min(Math.abs(delta) / 200, 0.1);
      if ((list.scrollTop === 0 && delta > 0) ||
          (list.scrollTop + list.clientHeight >= list.scrollHeight && delta < 0)) {
        buttons.forEach(function(btn) {
          btn.style.transform = 'scaleY(' + scale + ')';
        });
      }
    });
    list.addEventListener('touchend', function() {
      touching = false;
      buttons.forEach(function(btn) {
        btn.style.transition = 'transform 0.3s';
        btn.style.transform  = 'scaleY(1)';
        setTimeout(function() { btn.style.transition = ''; }, 300);
      });
    });
  });

  /**
   * Запуск анимации «выезд снизу» для всех кнопок.
   */
  function startAnim() {
    document.querySelectorAll('.btn').forEach(function(btn, i) {
      btn.style.animation = 'slideUp 0.6s ease-out both ' + (i * 0.05) + 's';
    });
  }
</script>


</body>
</html>
